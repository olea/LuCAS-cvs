<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>Enlazando funciones de carga dinámica</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.59"><LINK
REL="HOME"
TITLE="PostgreSQL"
HREF="postgres.html"><LINK
REL="UP"
TITLE="Guía del Programador"
HREF="part-programmer.html"><LINK
REL="PREVIOUS"
TITLE="GiST Indices"
HREF="gist.html"><LINK
REL="NEXT"
TITLE="DEC OSF/1"
HREF="x17911.html"></HEAD
><BODY
CLASS="CHAPTER"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PostgreSQL</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="gist.html"
>Anterior</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x17911.html"
>Siguiente</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="DFUNC"
>Enlazando funciones de carga dinámica</A
></H1
><P
>&#13;
   Después de crear y registrar una función definida por el usuario, el trabajo está 
   prácticamente terminado.<SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>, sim embargo debe cargar
   el fichero de código objeto (e.g., a <TT
CLASS="LITERAL"
>.o</TT
>, o una biblioteca compartida)
   que implemente esa funcuín. Como se ha mencionado anteriormente, <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>
   carga el código en tiempo de ejecución, a medida que es necesario. A fin de permitir
   que el código sea cargado dinámicamente, puede tener que compilar y enlazar este código
   de algún modo especial. esta sección explica brevemente como realizar la compilación y 
   el enlazado necesario antes de que pueda cargar sus funciones en un servidor <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>
   en ejecución. Nótese que este proceso ha cambiado respecto al de la versión 4.2.
  </P
><P
>   Debe estar preparado para leer (y releer, y re-releer) las páginas de manual del compilador
   de C, cc(1), y del enlazador, ld(1), por si necesita información específica. Además, los 
   paquetes de prueba de regresión del directorio <TT
CLASS="FILENAME"
>PGROOT/src/regress</TT
> 
   contienen varios ejemplos de estwe proceso. Si comprende lo que realizan estas pruebas, no 
   debería tener ningún problema.
  </P
><P
>   La siguiente terminología se usará más adelante:

   <P
></P
><UL
><LI
><P
>      <I
CLASS="FIRSTTERM"
>Carga dinámica (Dynamic loading)</I
>
      el lo que <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> hace con un fichero objeto. El fichero 
      objeto se copia en el servidor <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> en ejecución, y las 
      funciones y variables del fichero quedan disponibles para las funciones de los procesos 
      <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>. <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> hace ésto 
      usando el mecanismo de carga dinámica proporcionado por el sistema operativo.
     </P
></LI
><LI
><P
>      <I
CLASS="FIRSTTERM"
>Configuracion de la carga y enlazado (Loading and link editing)</I
>
      es lo que usted hace con un fichero objeto a fin de producir otro tipo de fichero objeto 
      (por ejemplo, un programa ejecutable o una biblioteca compartida). Esto se realiza por 
      medio del programa de configuración de enlazado, ld(1).
     </P
></LI
></UL
>
  </P
><P
>   Las siguientes restricciones generales y notas se aplican también al texto siguiente:
   <P
></P
><UL
><LI
><P
>      Las rutas dadas a la orden para crear la función deben ser absolutas (es decir, han de 
      empezar con "/"), y referirse a directorios visibles para la máquina en la que se está 
      ejecutando el servidor <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>.

      <DIV
CLASS="TIP"
><P
></P
><TABLE
CLASS="TIP"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="./stylesheet-images/tip.gif"
HSPACE="5"
ALT="Sugerencia"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>        Las rutas relativas tambien funcionan, pero hay que terner en cuenta que serían  
        relativas al directorio donde reside la base de datos (que es generalmente invisible 
        para las aplicaciones finales). Obviamente, no tiene sentido hacer la ruta relativa 
        al directorio en el que el usuario inicial la aplicacion final, dado que el servidor 
        puede estar ejecutándose en una máquina distinta.
       </P
></TD
></TR
></TABLE
></DIV
>
     </P
></LI
><LI
><P
>      El usuario <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> debe ser capaz de recorrer la ruta dada 
      a la orden de creación de la función, y ser capaz de leer el fichero objeto. Esto es 
      así porque el servidor <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> se ejecuta como usuario 
      <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>, no como el usuario que inicia el proceso final. 
      (Hacer el fichero el el directorio de nivel superior no leible y/o no ejecutable para 
      el usuario "postgres" es un error extremadamente común.)
     </P
></LI
><LI
><P
>      Los nombre de simbolos definidos en los fichero objetos no deben estar en conflicto 
      entre sí, ni con los simbolos definidos en <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> .
     </P
></LI
><LI
><P
>      El compilador de C GNU normalmente no dispone de las opciones especiales necesarias para 
      usar la interfase del cargador dinámico del systema. En caso de que esto ocurra, ha de 
      usarse el compilador de C que venga con el sistema operativo.
     </P
></LI
></UL
>
  </P
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN17905"
><SPAN
CLASS="ACRONYM"
>ULTRIX</SPAN
></A
></H1
><P
>    Es muy facil escribir ficheros objeto de carga dinámica bajo ULTRIX. ULTRIX no tiene 
    ningún mecanismo para bibliotecas compartidas, y por lo tanto, no plantea restricciones 
    a la interfase del cargador dinámico. Por otra parte, tendremos que (re)escribir un 
    cargador dinámico no portable, y no podremos usar verdaderas bibliotecas compartidas. 
    Bajo ULTRIX, la unica restriccion es que debe producir cada fichero objeto con la opcion 
    -G 0. (Nótese que es trata del número 0, no del literal "o"). Por ejemplo:
    <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
># simple ULTRIX example
% cc -G 0 -c foo.c
    </PRE
></TD
></TR
></TABLE
>
    produce un fichero objeto llamado foo.o que puede ser cargado dinámicamente en <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> .
    No ha de realizarse carga o enlazado adicional.
   </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="gist.html"
>Anterior</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="postgres.html"
>Inicio</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x17911.html"
>Siguiente</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>GiST Indices</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="part-programmer.html"
>Subir</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><SPAN
CLASS="ACRONYM"
>DEC OSF/1</SPAN
></TD
></TR
></TABLE
></DIV
></BODY
></HTML
>