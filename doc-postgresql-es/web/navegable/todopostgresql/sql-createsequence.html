<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>   CREATE SEQUENCE
  </TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.59"><LINK
REL="HOME"
TITLE="PostgreSQL"
HREF="postgres.html"><LINK
REL="UP"
TITLE="Instrucciones SQL"
HREF="sql-commands.html"><LINK
REL="PREVIOUS"
TITLE="   CREATE RULE
  "
HREF="sql-createrule.html"><LINK
REL="NEXT"
TITLE="   CREATE TABLE
  "
HREF="sql-createtable.html"></HEAD
><BODY
CLASS="REFENTRY"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PostgreSQL</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="sql-createrule.html"
>Anterior</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="sql-createtable.html"
>Siguiente</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="SQL-CREATESEQUENCE"
>CREATE SEQUENCE</A
></H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN6015"
></A
><H2
>Nombre</H2
>   CREATE SEQUENCE
  &nbsp;--&nbsp;   Crea una nueva secuencia de generador de numeros
  </DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN6018"
></A
><H2
>Synopsis</H2
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SYNOPSIS"
>CREATE SEQUENCE <TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
> [ INCREMENT <TT
CLASS="REPLACEABLE"
><I
>increment</I
></TT
> ]
    [ MINVALUE <TT
CLASS="REPLACEABLE"
><I
>minvalue</I
></TT
> ] [ MAXVALUE <TT
CLASS="REPLACEABLE"
><I
>maxvalue</I
></TT
> ]
    [ START <TT
CLASS="REPLACEABLE"
><I
>start</I
></TT
> ] [ CACHE <TT
CLASS="REPLACEABLE"
><I
>cache</I
></TT
> ] [ CYCLE ]
  </PRE
></TD
></TR
></TABLE
><DIV
CLASS="REFSECT2"
><A
NAME="R2-SQL-CREATESEQUENCE-1"
></A
><H3
>    Entradas
   </H3
><P
>&#13;    <P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
></DT
><DD
><P
>	El nombre de una secuencia que sera creada.
       </P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>increment</I
></TT
></DT
><DD
><P
>	La clausula
	<TT
CLASS="OPTION"
>INCREMENT <TT
CLASS="REPLACEABLE"
><I
>increment</I
></TT
></TT
>
	es opcional. Un valor positivo hara una
	secuencia ascendente, uno negativo hara una secuencia descendente.
	El valor por omision es uno (1).
       </P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>minvalue</I
></TT
></DT
><DD
><P
>	La clausula opcional <TT
CLASS="OPTION"
>MINVALUE
	 <TT
CLASS="REPLACEABLE"
><I
>minvalue</I
></TT
></TT
>
	determina el valor minimo
	que una secuencia puede generar. El valor por omision es 1 y -2147483647 para
	secuencias ascendentes y descendentes, respectivamente.
       </P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>maxvalue</I
></TT
></DT
><DD
><P
>	Utilice la clausula opcional <TT
CLASS="OPTION"
>MAXVALUE
	 <TT
CLASS="REPLACEABLE"
><I
>maxvalue</I
></TT
></TT
> para
	determinar el valor
	maximo para una secuencia. Por omision son 2147483647 y -1 para
	secuencias ascendentes y descendentes, respectivamente.
       </P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>start</I
></TT
></DT
><DD
><P
>	La clausula opcional <TT
CLASS="OPTION"
>START
	 <TT
CLASS="REPLACEABLE"
><I
>start</I
></TT
>
	 </TT
> habilita la secuencia para que comience en cualquier lugar.
	El valor de inicio por omision es
	<TT
CLASS="REPLACEABLE"
><I
>minvalue</I
></TT
>
	para secuencias ascendentes y
	<TT
CLASS="REPLACEABLE"
><I
>maxvalue</I
></TT
>
	para las descendentes.
       </P
></DD
><DT
><TT
CLASS="REPLACEABLE"
><I
>cache</I
></TT
></DT
><DD
><P
>	La opcion <TT
CLASS="OPTION"
>CACHE <TT
CLASS="REPLACEABLE"
><I
>cache</I
></TT
></TT
> 
	permite que los numeros de la secuencia sean alojados (preallocated)
	y almacenados en memoria para un acceso mas rapido. El valor minimo
	es 1 (solo se puede generar un valor cada vez, i.e. sin cache)
	y es tambien el valor por omision.
       </P
></DD
><DT
>CYCLE</DT
><DD
><P
>	La palabra clave (keyword) CYCLE puede ser utulizada para permitir a la secuencia
	continuar cuando el valor de 
	<TT
CLASS="REPLACEABLE"
><I
>maxvalue</I
></TT
> o el de 
	<TT
CLASS="REPLACEABLE"
><I
>minvalue</I
></TT
> ha sido
	alcanzado por 
	una secuencia ascendente o descendente respectivamente. Si el limite es alcanzado, 
	el siguiente numero generado sera cualquiera que para
	<TT
CLASS="REPLACEABLE"
><I
>minvalue</I
></TT
> o
	<TT
CLASS="REPLACEABLE"
><I
>maxvalue</I
></TT
> sea 
	tomado como apropiado.
       </P
></DD
></DL
></DIV
>
   </P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="R2-SQL-CREATESEQUENCE-2"
></A
><H3
>    Outputs
   </H3
><P
>&#13;    <P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="COMPUTEROUTPUT"
>CREATE
       </TT
></DT
><DD
><P
>	Mensaje devuelto si el comando es ejecutado con exito.
       </P
></DD
><DT
><TT
CLASS="COMPUTEROUTPUT"
>ERROR:  Relation '<TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
>' already exists
       </TT
></DT
><DD
><P
>	Si la secuencia especificada ya existe.
       </P
></DD
><DT
><TT
CLASS="COMPUTEROUTPUT"
>ERROR:  DefineSequence: MINVALUE (<TT
CLASS="REPLACEABLE"
><I
>start</I
></TT
>) can't be &#62;= MAXVALUE (<TT
CLASS="REPLACEABLE"
><I
>max</I
></TT
>)
       </TT
></DT
><DD
><P
>	Si el valor de inicio especificado esta fuera de rango.
       </P
></DD
><DT
><TT
CLASS="COMPUTEROUTPUT"
>ERROR:  DefineSequence: START value (<TT
CLASS="REPLACEABLE"
><I
>start</I
></TT
>) can't be &#60; MINVALUE (<TT
CLASS="REPLACEABLE"
><I
>min</I
></TT
>)
       </TT
></DT
><DD
><P
>	Si el valor de inicio especificado esta fuera de rango.
       </P
></DD
><DT
><TT
CLASS="COMPUTEROUTPUT"
>ERROR:  DefineSequence: MINVALUE (<TT
CLASS="REPLACEABLE"
><I
>min</I
></TT
>) can't be &#62;= MAXVALUE (<TT
CLASS="REPLACEABLE"
><I
>max</I
></TT
>)
       </TT
></DT
><DD
><P
>	Si el valor minimo y maximo son inconsistentes.
       </P
></DD
></DL
></DIV
>
   </P
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-SQL-CREATESEQUENCE-1"
></A
><H2
>   Descripcion
  </H2
><P
>   <B
CLASS="COMMAND"
>CREATE SEQUENCE</B
> introducira una nueva secuencia generadora de numeros
   dentro de la actual base de datos. Esto implica la creacion e inicializacion de una
   nueva tabla
   de una linea con el nombre <TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
>.
   La secuencia generadora sera propiedad del usuario que ejecuta el comando.
  </P
><P
>   Depsues de que se crea una secuencia, puede utilizar la funcion
   <TT
CLASS="FUNCTION"
>nextval(<TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
>)</TT
>
   par aobtener una nuevo numero de la secuencia.
   La funcion 
   <TT
CLASS="FUNCTION"
>currval('<TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
>')</TT
>
   puede ser utilizada para determinar el numerp devuelto por la ultima llamada a 
   <TT
CLASS="FUNCTION"
>nextval(<TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
>)</TT
>
   desde la secuencia especificada en la sesion en curso.
   La funcion 
   <TT
CLASS="FUNCTION"
>setval('<TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
>',
    <TT
CLASS="REPLACEABLE"
><I
>newvalue</I
></TT
>)</TT
>
   puede ser utilizada para configurar el valor actual de la secuencia especificada.
   La siguiente llamada a  
   <TT
CLASS="FUNCTION"
>nextval(<TT
CLASS="REPLACEABLE"
><I
>seqname</I
></TT
>)</TT
>
   devolvera el valor dado mas la secuencia de incremento.
  </P
><P
>   Utilice una consulta (query) como 

   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>SELECT * FROM sequence_name;
   </PRE
></TD
></TR
></TABLE
>

   para obtener los parametros de una secuencia.

   Aparte de obtener los parametros
   originales, puede utilizar

   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>SELECT last_value FROM sequence_name;
   </PRE
></TD
></TR
></TABLE
>

   para obtener el ultimo valor asignado por cualquier proceso en el servidor (backend).
   to obtain the last value allocated by any backend.
   parametros que puedes utilizar
  </P
><P
>   Se utliza bajo nivel de bloque para habilitar multiples llamadas
   simultaneas a un generador.
  </P
><DIV
CLASS="CAUTION"
><P
></P
><TABLE
CLASS="CAUTION"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="./stylesheet-images/caution.gif"
HSPACE="5"
ALT="Atención"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>    Se pueden obtener resultados inesperados si una configuracion de cache mayor que uno
    es utilizada por un objeto secuencia que sera usado concurrentemente por multiples
    procesos en el servidor (backends).  Cada proceso en el servidor (backend)asignara 
    valores de secuencia "cache" succesivas durante un acceso al objeto secuencia e incrementara
    el ultimo valor (last_value) del objeto secuencia en conformidad con esto.
    De este modo, el siguiente uso de cache-1 de nextval dentro de ese proceso en el servidor (backend)
    devolvera simplemente los valores asignados sin tocar el objeto compartido. Asi pues, 
    los numeros asignados pero no utilizados en la sesion en curso se perderan. 
    Mas aun, aunque se garantice por multiples procesos en el servidor (backends) 
    la asignacion de distintos valores de secuencia, los valores pueden ser generados 
    fuera de secuencia cuando los procesos en el servidor (backends) son tenidos en cuenta. 
    (Por ejemplo, con una configuracion de cache de 10, el proceso A puede reservar valores 1..10 
    y devolver un nextval=1, entonces el proceso B puede reservar valores 11..20 y devolver 
    un nextval=11 antes de que el proceso A ha generado un nextval=2.) 
    Asi, con una configuracion de cache de uno es seguro asumir que los valores de nextval 
    seran generados secuencialmente; conuna cache configurada mayor que uno solo podrias asumir 
    que los valores de nextvalue seran todos distintos, no que seran todos generados de un modo 
    puramente secuencial. Tambien, last_value reflejara el ultimo valor reservado por cualquier 
    proceso en el servidor (backend), tanto si ya ha sido devuelto por nextval como si no.
  </P
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="R2-SQL-CREATESEQUENCE-3"
></A
><H3
>    Notas
   </H3
><P
>    Remitase a estado <B
CLASS="COMMAND"
>DROP SEQUENCE</B
> para eliminar una secuencia.
   </P
><P
>    Cada proceso en el servidor (backend) utiliza su propia cache para almacenar numeros asignados.
    Los numeros que estan en la cache pero no son utilizado en la sesion en curso se perderan,
    dando como resultado "vacios" en la secuencia.
   </P
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-SQL-CREATESEQUENCE-2"
></A
><H2
>   Uso
  </H2
><P
>   Crea una secuencia ascendente llamada <TT
CLASS="LITERAL"
>serial</TT
>, comenzando en 101:
  </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>CREATE SEQUENCE serial START 101;
  </PRE
></TD
></TR
></TABLE
><P
>   Seleccione el siguiente numero de esta secuencia
   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>SELECT NEXTVAL ('serial');
    
nextval
-------
    114
   </PRE
></TD
></TR
></TABLE
>
  </P
><P
>   Utilice esta secuencia en una INSERT:
   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>INSERT INTO distributors VALUES (NEXTVAL('serial'),'nothing');
   </PRE
></TD
></TR
></TABLE
>
  </P
><P
>   Configurar el valor de la secuencia despues de un COPY FROM:
   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>CREATE FUNCTION distributors_id_max() RETURNS INT4
    AS 'SELECT max(id) FROM distributors' 
    LANGUAGE 'sql';
BEGIN;
    COPY distributors FROM 'input_file';
    SELECT setval('serial', distributors_id_max());
END;
   </PRE
></TD
></TR
></TABLE
>
  </P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-SQL-CREATESEQUENCE-3"
></A
><H2
>   Compatibilidad
  </H2
><DIV
CLASS="REFSECT2"
><A
NAME="R2-SQL-CREATESEQUENCE-4"
></A
><H3
>    SQL92
   </H3
><P
>    <B
CLASS="COMMAND"
>CREATE SEQUENCE</B
> es una extension de lenguaje 
    <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>.
    No hay estado <B
CLASS="COMMAND"
>CREATE SEQUENCE</B
> 
    en <SPAN
CLASS="ACRONYM"
>SQL92</SPAN
>.
   </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="sql-createrule.html"
>Anterior</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="postgres.html"
>Inicio</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="sql-createtable.html"
>Siguiente</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>CREATE RULE</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="sql-commands.html"
>Subir</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>CREATE TABLE</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>