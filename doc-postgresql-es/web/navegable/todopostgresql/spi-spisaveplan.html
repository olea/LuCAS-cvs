<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>SPI_saveplan</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.59"><LINK
REL="HOME"
TITLE="PostgreSQL"
HREF="postgres.html"><LINK
REL="UP"
TITLE="Interface Functions"
HREF="spi.html#AEN18016"><LINK
REL="PREVIOUS"
TITLE="SPI_prepare"
HREF="spi-spiprepare.html"><LINK
REL="NEXT"
TITLE="SPI_execp"
HREF="spi-spiexecp.html"></HEAD
><BODY
CLASS="REFENTRY"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PostgreSQL</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="spi-spiprepare.html"
>Anterior</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="spi-spiexecp.html"
>Siguiente</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="SPI-SPISAVEPLAN"
>SPI_saveplan</A
></H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN18337"
></A
><H2
>Nombre</H2
>SPI_saveplan&nbsp;--&nbsp;   Saves a passed plan</DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN18345"
></A
><H2
>Synopsis</H2
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SYNOPSIS"
>SPI_saveplan(<TT
CLASS="REPLACEABLE"
><I
>plan</I
></TT
>)</PRE
></TD
></TR
></TABLE
><DIV
CLASS="REFSECT2"
><A
NAME="R2-SPI-SPISAVEPLAN-1"
></A
><H3
>Inputs</H3
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>void *<TT
CLASS="REPLACEABLE"
><I
>query</I
></TT
></DT
><DD
><P
>Passed plan</P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="R2-SPI-SPISAVEPLAN-2"
></A
><H3
>Outputs</H3
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>void *</DT
><DD
><P
>Execution plan location. NULL if unsuccessful.</P
></DD
><DT
>SPI_result</DT
><DD
><P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
>   <SPAN
CLASS="RETURNVALUE"
>SPI_ERROR_ARGUMENT</SPAN
> if plan is NULL</TD
></TR
><TR
><TD
>   <SPAN
CLASS="RETURNVALUE"
>SPI_ERROR_UNCONNECTED</SPAN
> if procedure is un-connected</TD
></TR
></TBODY
></TABLE
><P
></P
></P
></DD
></DL
></DIV
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-SPI-SPISAVEPLAN-1"
></A
><H2
>Description</H2
><P
><TT
CLASS="FUNCTION"
>SPI_saveplan</TT
> 
   stores a plan prepared by <TT
CLASS="FUNCTION"
>SPI_prepare</TT
> in safe memory
   protected from freeing by <TT
CLASS="FUNCTION"
>SPI_finish</TT
> or the transaction manager.</P
><P
>   In the current version of <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> there is no ability to
 store prepared plans in the system
   catalog and fetch them from there for execution. This will be implemented
   in future versions.

   As an alternative, there is the ability to reuse prepared plans in the
   consequent invocations of your procedure in the current session.
   Use <TT
CLASS="FUNCTION"
>SPI_execp</TT
> to execute this saved plan.</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-SPI-SPISAVEPLAN-2"
></A
><H2
>Usage</H2
><P
>   <TT
CLASS="FUNCTION"
>SPI_saveplan</TT
> saves a passed plan (prepared by <TT
CLASS="FUNCTION"
>SPI_prepare</TT
>) in memory
   protected from freeing by <TT
CLASS="FUNCTION"
>SPI_finish</TT
> and by the transaction manager and
   returns a pointer to the saved plan.  You may save the pointer returned in
   a local variable.  Always check if this pointer is NULL or not either when
   preparing a plan or using an already prepared plan in SPI_execp (see below).

<DIV
CLASS="NOTE"
><P
></P
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="./stylesheet-images/note.gif"
HSPACE="5"
ALT="Nota"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>   If one of the objects (a relation, function, etc.) referenced by the prepared
   plan is dropped during your session (by your backend or another process) then the
   results of <TT
CLASS="FUNCTION"
>SPI_execp</TT
> for this plan will be unpredictable.</P
></TD
></TR
></TABLE
></DIV
>&#13;</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="spi-spiprepare.html"
>Anterior</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="postgres.html"
>Inicio</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="spi-spiexecp.html"
>Siguiente</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>SPI_prepare</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="spi.html#AEN18016"
>Subir</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>SPI_execp</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>